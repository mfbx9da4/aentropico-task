<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<meta content="width=device-width" name="viewport">
<meta content="yes" name="apple-mobile-web-app-capable">

<title>Diving deep into the AngularUI Router | ng-newsletter</title>

<meta name="author" content="Ari Lerner">
<meta name="description" content=" angularjs angularjs tutorial angular">
<meta name="keywords" content="angularjs angular-ui angular menu angularjs doubleclick angularjs dblclick dblclick angularjs quickstart beginner angularjs angularjs tutorial angular realtime firebase angularfire">

<meta name="msvalidate.01" content="BE7DA3BEF0F11153F6E4B5585C12DB20" />
<meta property="og:type" content="website" />
<meta property="og:title" content="ng-newsletter" />
<meta property="og:url" content="http://ng-newsletter.com" />
<meta property="og:image" content="http://ng-newsletter.com/img/" />
<meta property="og:description" content="" />

<meta name="twitter:card" value="summary" />
<meta name="twitter:creator" value="@auser" />
<meta name="twitter:title" value="ng-newsletter" />
<meta name="twitter:description" value="" />
<meta name="twitter:image" value="http://ng-newsletter.com/img/" />

<link rel="alternate" type="application/rss+xml" href="feed.rss" title="Sitewide RSS 2.0 Feed">
<link rel="alternate" type="application/atom+xml" href="atom.xml" title="Sitewide ATOM Feed">
<link rel="alternate" type="application/atom+json" href="atom.json" title="Sitewide JSON Feed">

<link href="/favicon.ico" rel="icon" type="image/ico" />
<link href="/css/site.css" media="screen" rel="stylesheet" type="text/css" /><link href="http://fonts.googleapis.com/css?family=Roboto:400italic,700italic,400,700|Open+Sans:r,i,b,bi|Bitter:r,i,b" media="screen" rel="stylesheet" type="text/css" />
<script src="/js/vendor/custom.modernizr.js"></script>
<script src="/js/vendor/d3.v3.min.js"></script>
<script src="/js/vendor/angular/angular.min.js"></script>
<script src="/js/vendor/angular-route/angular-route.min.js"></script>
<script src="/js/vendor/angular-animate.min.js"></script>
<script src="/js/vendor/angular-translate.min.js"></script>
<script src="/js/vendor/angular-cookies/angular-cookies.min.js"></script>


</head>
<body ng-app="uiAngularApp">

    
    <div id="header">
  <div id="topNav">
    <nav class="top-bar">
      <ul class="title-area">
        <li class="name">
          <h1><a href="/">ng-newsletter</a></h1>
        </li>
        <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
      </ul>

      <section class="top-bar-section">
        <ul class="right">
      		<li><a href="/posts">Articles</a></li>
          <li><a href="/advent2013/">25 days of Angular</a></li>
          <li><a href="/books">Books</a></li>
          <li><a href="/sponsor">Sponsorship</a></li>
        </ul>
      </section>
    </nav>
  </div>
  <div class="headerContent">
  </div>
</div>

    <div class="container">
      <div id="article">
        <article class="post">
          <header>
            <h1 class="mega">Diving deep into the AngularUI Router</h1>
          </header>
          
          <p>AngularJS is packed with out-of-the-box features that we can use to build an expressive AngularJS app without relying on separate libraries; however, the <strong>very active</strong> AngularJS community has also built some great libraries that we can take advantage of to maximize the power of our apps.</p>

<p>This post is the first post in our mini-series where we&rsquo;re covering professional components of the <a href="http://angular-ui.github.io/">AngularUI</a> library. In this post, we&rsquo;ll walk through the <code>ui-router</code>.</p>

<p>The AngularUI library has been broken out into several modules so that, rather than including the entire suite, we can pick and choose the components that we&rsquo;re interested in using.</p>

<p><strong>Quick links:</strong> we&rsquo;ve included two major demos in this article that we are constantly asked about in our classes.</p>

<ul>
<li><a href="#namedviews">Multiple named views</a></li>
<li><a href="#wizard">Wizard form</a></li>
</ul>

<h2>UI-Router</h2>

<p>The <code>ui-router</code> library is one of the most useful that the AngularUI library gives us. It&rsquo;s a routing framework that allows us to organize our interface by a state machine, rather than a simple URL route. </p>

<p>This library provides for a lot of extra control in our views. We can created nested views, use multiple views on the same page, have multiple views that control a single view, and more. For finer grain control and more complex applications, the <code>ui-router</code> is a great library to harness.</p>

<h3>Installation</h3>

<p>To install the <code>ui-router</code> library, we can either download the <a href="http://angular-ui.github.io/ui-router/release/angular-ui-router.js">release</a> or use Bower:</p>
<pre class="highlight shell"><span class="gp">$ </span>bower install angular-ui-router --save
</pre>
<p>We need to link the library to our view:</p>
<pre class="highlight html"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;app/bower_components/angular-ui-router/release/angular-ui-router.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre>
<p>And we need to inject the <code>ui.router</code> as a dependency in our app:</p>
<pre class="highlight javascript"><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'myApp'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'ui.router'</span><span class="p">])</span>
</pre>
<p>Now, unlike the built-in <code>ngRoute</code> service, the <code>ui-router</code> can nest views, as it works based off states, not just a URL.</p>

<p>Instead of using the <code>ng-view</code> directive as we do with the <code>ngRoute</code> service, we&rsquo;ll use the <code>ui-view</code> directive with <code>ngRoute</code>. </p>

<p>When dealing with routes and states inside of <code>ui-router</code>, we&rsquo;re mainly concerned with which state the application is in as well as at which route the web app currently stands.</p>
<pre class="highlight html"><span class="nt">&lt;div</span> <span class="na">ng-controller=</span><span class="s">&quot;DemoController&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">ui-view</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre>
<p>Just like <code>ngRoute</code>, the templates we define at any given state will be placed inside of the <code>&lt;div ui-view&gt;&lt;/div&gt;</code> element. Each of these templates can include their own <code>ui-view</code> as well, which is how we can have <em>nested</em> views inside our routes.</p>

<p>To define a route, we use the <code>.config</code> method, just like normal, but instead of setting our routes on <code>$routeProvider</code>, we set our <em>states</em> on the <code>$stateProvider</code>. </p>
<pre class="highlight javascript"><span class="p">.</span><span class="nx">config</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$stateProvider</span><span class="p">,</span> <span class="nx">$urlRouterProvider</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$stateProvider</span>
    <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'start'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'/start'</span><span class="p">,</span>
      <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'partials/start.html'</span>
    <span class="p">})</span>
<span class="p">});</span>
</pre>
<p>This step assigns the <em>state</em> named <code>start</code> to the state configuration object. The state configuration object, or the <code>stateConfig</code>, has similar options to the route config object, which is how we can configure our states.</p>

<h4>template, templateUrl, templateProvider</h4>

<p>We can set up templates on each of our views using one of the three following options:</p>

<ul>
<li><code>template</code> - A string of HTML content or a function that returns HTML</li>
<li><code>templateUrl</code> - A string URL path to a template or a function that returns a URL path string</li>
<li><code>templateProvider</code> - A function that returns an HTML content string</li>
</ul>

<p>For instance:</p>
<pre class="highlight javascript"><span class="nx">$stateProvider</span><span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'home'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h1&gt;Hello {{ name }}&lt;/h1&gt;'</span>
<span class="p">});</span>
</pre>
<h4>Controller</h4>

<p>Just like in <code>ngRoute</code>, we can either associate an already registered controller with a URL (via a string) or we can create a controller function that operates as the controller for the state.</p>

<p>If there is no template defined (in one of the previous options), then the controller will <strong>not</strong> be created.</p>

<h4>Resolve</h4>

<p>Using the <code>resolve</code> functionality, we can resolve a list of dependencies that we can inject into our controller. In <code>ngRoute</code>, the <code>resolve</code> option allows us to resolve promises before the route is actually rendered. Inside <code>angular-route</code>, we have a bit more freedom as to how we can use this option.</p>

<p>The <code>resolve</code> option takes an object where the keys are the names of the dependency to inject into the controller and the values are the <code>factories</code> that are to be resolved.</p>

<p>If a string is passed, then <code>angular-route</code> will try to match an existing registered service. If a function is passed, then the function is injected, and the return value of the function is the dependency. If the function returns a promise, it is resolved <em>before</em> the controller is instantitated and the value (just like <code>ngRoute</code>) is injected into the controller.</p>
<pre class="highlight javascript"><span class="nx">$stateProvider</span><span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'home'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">resolve</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1">// This will return immediately as the 
</span>    <span class="c1">// result is not a promise
</span>    <span class="nl">person</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="s2">&quot;Ari&quot;</span><span class="p">,</span>
        <span class="na">email</span><span class="p">:</span> <span class="s2">&quot;<a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="3554475c7553405959464154565e1b5c5a">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script>&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="c1">// This function returns a promise, therefore
</span>    <span class="c1">// it will be resolved before the controller
</span>    <span class="c1">// is instantiated
</span>    <span class="nl">currentDetails</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$http</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">$http</span><span class="p">({</span>
        <span class="na">method</span><span class="p">:</span> <span class="s1">'JSONP'</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">'/current_details'</span>
      <span class="p">});</span>
    <span class="p">},</span>
    <span class="c1">// We can use the resulting promise in another
</span>    <span class="c1">// resolution
</span>    <span class="nl">facebookId</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$http</span><span class="p">,</span> <span class="nx">currentDetails</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$http</span><span class="p">({</span>
        <span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">'http://facebook.com/api/current_user'</span><span class="p">,</span>
        <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">email</span><span class="p">:</span> <span class="nx">currentDetails</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">emails</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
      <span class="p">})</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">controller</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">person</span><span class="p">,</span> 
                <span class="nx">currentDetails</span><span class="p">,</span> <span class="nx">facebookId</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">person</span> <span class="o">=</span> <span class="nx">person</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})</span>
</pre>
<h4>URL</h4>

<p>The <code>url</code> option will assign a URL that the application is at to a specific state inside our app. That way, we can get the same features of deep linking while navigating around the app by state, rather than simply by URL.</p>

<p>This option is similar to the <code>ngRoute</code> URL, but can be considered a major upgrade, as we&rsquo;ll see in a moment.</p>

<p>We can specify the basic route like so:</p>
<pre class="highlight javascript"><span class="nx">$stateProvider</span>
  <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'inbox'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'/inbox'</span><span class="p">,</span>
    <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h1&gt;Welcome to your inbox&lt;/h1&gt;'</span>
  <span class="p">});</span>
</pre>
<p>When the user navigates to <code>/inbox</code>, then the app will transition into the <code>inbox</code> state and fill the main <code>ui-view</code> directive with the contents of the template (<code>&lt;h1&gt;Welcome to your inbox&lt;/h1&gt;</code>). </p>

<p>The URL can take several different options, which makes it incredibly powerful. We can set the basic parameters in the URL like we do in <code>ngRoute</code>:</p>
<pre class="highlight javascript"><span class="nx">$stateProvider</span>
  <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'inbox'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'/inbox/:inboxId'</span><span class="p">,</span>
    <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h1&gt;Welcome to your inbox&lt;/h1&gt;'</span><span class="p">,</span>
    <span class="na">controller</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$stateParams</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">inboxId</span> <span class="o">=</span> <span class="nx">$stateParams</span><span class="p">.</span><span class="nx">inboxId</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">});</span>
</pre>
<p>Now we&rsquo;ll capture the <code>:inboxId</code> as the second component in the URL. For instance, if the app transitions to <code>/inbox/1</code>, then <code>$stateParams.inboxId</code> becomes 1 (as <code>$stateParams</code> will be <code>{inboxId: 1}</code>).</p>

<p>We can also use a different syntax:</p>
<pre class="highlight javascript"><span class="nx">url</span><span class="err">:</span> <span class="s1">'/inbox/{inboxId}'</span>
</pre>
<p>The path must match the URL exactly. Unlike <code>ngRoute</code>, if the user navigates to <code>/inbox/</code>, the above path <em>will</em> work; however, if she navigates to <code>/inbox</code>, the above state will <em>not</em> be activated.</p>

<p>The path also enables us to use regex inside of parameters so that we can set a rule to match against our route. For instance:</p>
<pre class="highlight javascript"><span class="c1">// Match only inbox ids that contain
// 6 hexidecimal digits
</span><span class="nx">url</span><span class="err">:</span> <span class="s1">'/inbox/{inboxId:[0-9a-fA-F]{6}}'</span><span class="p">,</span>
<span class="c1">// Or
// match every url at the end of `/inbox`
// to `inboxId` (a catch-all)
</span><span class="nx">url</span><span class="err">:</span> <span class="s1">'/inbox/{inboxId:.*}'</span>
</pre>
<blockquote>
<p>Note, we cannot use capture groups inside the route: The route resolver is not able to resolve the route.</p>
</blockquote>

<p>We can even specify query parameters in our route:</p>
<pre class="highlight javascript"><span class="c1">// will match a route such as
// /inbox?sort=ascending
</span><span class="nx">url</span><span class="err">:</span> <span class="s1">'/inbox?sort'</span>
</pre>
<h4>Nested routing</h4>

<p>We can use the <code>url</code> parameter to append routes in order to provide for nested routes. Using it in this way enables us to support having multiple <code>ui-views</code> inside our page and our templates. For instance, we can nest individual routes inside of our <code>/inbox</code> route above. </p>
<pre class="highlight javascript"><span class="nx">$stateProvider</span>
  <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'inbox'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'/inbox/:inboxId'</span><span class="p">,</span>
    <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;div&gt;&lt;h1&gt;Welcome to your inbox&lt;/h1&gt;\
            &lt;a ui-sref=&quot;inbox.priority&quot;&gt;Show priority&lt;/a&gt;\
            &lt;div ui-view&gt;&lt;/div&gt;\
            &lt;/div&gt;'</span><span class="p">,</span>
    <span class="na">controller</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$stateParams</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">inboxId</span> <span class="o">=</span> <span class="nx">$stateParams</span><span class="p">.</span><span class="nx">inboxId</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'inbox.priority'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'/priority'</span><span class="p">,</span>
    <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h2&gt;Your priority inbox&lt;/h2&gt;'</span>
  <span class="p">});</span>
</pre>
<p>Our first route will match as we expect from above. We now also have a second route, a child route that matches under the <code>inbox</code> route: Our syntax (<code>.</code>) indicates that it is a child.</p>

<p><code>/inbox/1</code> matches the first state, and <code>/inbox/1/priority</code> matches the second state. With this syntax, we can support a nested URL inside of the parent route. The <code>ui-view</code> inside of the parent view will resolve to the <code>priority</code> inbox.</p>

<h4>Params</h4>

<p>The <code>params</code> option is an array of parameter names or regexes. This option <strong>cannot</strong> be combined with the <code>url</code> option. When the state becomes active, the app will populate the <code>$stateParams</code> service with these parameters.</p>

<h4>Views</h4>

<p>We can set multiple <em>named</em> views inside of a state. This feature is a particularly powerful one in <code>ui-router</code>: Inside of a single view, we can define multiple views that we can reference inside of a single template.</p>

<blockquote>
<p>If we set the <code>views</code> parameter, then the state&rsquo;s <code>templateUrl</code>, <code>template</code>, and <code>templateProvider</code> will be ignored. If we want to include a parent template in our routes, we&rsquo;ll need to create an abstract template the contains a template.</p>
</blockquote>

<p>Let&rsquo;s say we have a view that looks like:</p>
<pre class="highlight html"><span class="nt">&lt;div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">ui-view=</span><span class="s">&quot;filters&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">ui-view=</span><span class="s">&quot;mailbox&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">ui-view=</span><span class="s">&quot;priority&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre>
<p>We can now create <em>named</em> views that fill each of these individual templates. Each of the subviews can contain their own templates, controllers, and resolve data.</p>
<pre class="highlight javascript"><span class="nx">$stateProvider</span>
  <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'inbox'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">views</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">'filters'</span><span class="err">:</span> <span class="p">{</span>
        <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h4&gt;Filter inbox&lt;/h4&gt;'</span><span class="p">,</span>
        <span class="na">controller</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{}</span>
      <span class="p">},</span>
      <span class="s1">'mailbox'</span><span class="err">:</span> <span class="p">{</span>
        <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'partials/mailbox.html'</span>
      <span class="p">},</span>
      <span class="s1">'priority'</span><span class="err">:</span> <span class="p">{</span>
        <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h4&gt;Priority inbox&lt;/h4&gt;'</span><span class="p">,</span>
        <span class="na">resolve</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">facebook</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">FB</span><span class="p">.</span><span class="nx">messages</span><span class="p">();</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>
</pre>
<p>In this example, we have two named views embedded inside an abstract view.</p>

<div id="namedviews"></div>

<h4>See it</h4>

<div ari-iframe>
  <div id="app" ng-app="panesApp">
    <div ng-controller="NestedViewsController">
      <h2>Multiple named views</h2>
      <div ui-view></div>
    </div>
  </div>
  <script type="text/javascript" src="/js/vendor/angular-ui-router/release/angular-ui-router.min.js"></script>
  <script type="text/javascript" src="/js/posts/d3.js"></script>
  <script type="text/javascript">
    angular.module('panesApp', [
      'd3',
      'ui.router',
      'panesApp.controllers'
      ])
    .config(['$stateProvider', '$urlRouterProvider', function($stateProvider, $urlRouterProvider) {
      $urlRouterProvider.otherwise('/');

      $stateProvider
        .state('parent', {
          abstract: true,
          template: '<div class="row">\
            <div class="large-4 small-4 columns" ui-view="data"></div>\
            <div class="large-8 small-8 columns" ui-view="d3"></div>\
            </div>\
            <style type="text/css"> .chart rect {stroke:white;}</style>'
        })
        .state('parent.home', {
          url: '/',
          views: {
            data: {
              template: '<table>\
                <thead>\
                  <tr><th colspan="2">Girls to boys percent</th></tr>\
                </thead>\
                <tbody>\
                  <tr ng-repeat="obj in data">\
                    <td ng-bind="data[$index].name"></td>\
                    <td><input ng-model="data[$index].percent" type="number" min="1" placeholder="Percent" /></td>\
                  </tr>\
                </tbody></table>'
            },
            d3: {
              template: '<div id="d3"></div>',
              controller: function($scope, d3Service) {
                d3Service.d3().then(function(d3) {

                  var width = 400,
                      height = 150,
                      color = d3.scale.category20();

                  var chart = d3.select(
                      document.getElementById("d3")
                      ).append("svg")
                      .attr("class", "chart")
                      .attr("width", width)
                      .attr("height", height)
                      .append("g")
                      .attr("transform", "translate(10,15)");

                    $scope.$watch('data', function(newData) {
                      var data = [];
                      angular.forEach(newData, function(d) {
                        data.push(d.percent);
                      });
                      $scope.render(data);
                    }, true);

                  $scope.render = function(data) {
                    chart.selectAll('*').remove();

                    var x = d3.scale.linear()
                        .domain([0, d3.max(data)])
                        .range(["0px", width + "px"]);
                    var y = d3.scale.ordinal()
                        .domain(data)
                        .rangeBands([0, 120]);

                  chart.selectAll("line")
                      .data(x.ticks(10))
                    .enter().append("line")
                      .attr("x1", x)
                      .attr("x2", x)
                      .attr("y1", 0)
                      .attr("y2", 120)
                      .style("stroke", "#ccc");

                  chart.selectAll(".rule")
                      .data(x.ticks(10))
                    .enter().append("text")
                      .attr("class", "rule")
                      .attr("x", x)
                      .attr("y", 0)
                      .attr("dy", -3)
                      .attr("text-anchor", "middle")
                      .text(String);

                  chart.selectAll("rect")
                      .data(data)
                    .enter().append("rect")
                      .attr("y", y)
                      .attr("width", x)
                      .attr("height", y.rangeBand())
                      .attr('fill', function(d) {
                        return color(d);
                      });

                  chart.selectAll(".bar")
                      .data(data)
                    .enter().append("text")
                      .attr("class", "bar")
                      .attr("x", x)
                      .attr("y", function(d) { return y(d) + y.rangeBand() / 2; })
                      .attr("dx", -12)
                      .attr("dy", ".35em")
                      .attr("text-anchor", "end")
                      .text(String);

                  chart.append("line")
                      .attr("y1", 0)
                      .attr("y2", 120)
                      .style("stroke", "#000");

                  };
                  $scope.render();
                });
              }
            }
          }
        });
    }]);
    angular.module('panesApp.controllers', [])
    .controller('NestedViewsController', ['$scope', '$state', function($scope, $state) {
      $scope.data = [
        {name: "Chrome", percent:20},
        {name: "Firefox", percent:30},
        {name: "Safari", percent:60}
      ];
      $scope.signup = function() {
      }
    }]);
  </script>
</div>

<p><a href="https://gist.github.com/auser/6590929" target="_blank">Full source</a></p>

<h4>Abstract</h4>

<p>We can never directly activate an abstract template, but we can set up descendants to activate.</p>

<p>Abstract templates can provide a template wrapper around multiple named views, or they can pass <code>$scope</code> objects to descendant children. We can use them to pass around resolved dependencies or custom data or simply to nest several routes under the same &lsquo;url&rsquo; (e.g., have all routes under the <code>/admin</code> URL).</p>

<p>Setting up an abstract template is just like setting up a regular state, except that we&rsquo;ll set the <code>abstract</code> property:</p>
<pre class="highlight javascript"><span class="nx">$stateProvider</span>
  <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'admin'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">abstract</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'/admin'</span><span class="p">,</span>
    <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;div ui-view&gt;&lt;/div&gt;'</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'admin.index'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'/index'</span><span class="p">,</span>
    <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h3&gt;Admin index&lt;/h3&gt;'</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'admin.users'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'/users'</span><span class="p">,</span>
    <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;ul&gt;...&lt;/ul&gt;'</span>
  <span class="p">});</span>
</pre>
<h4>onEnter, onExit</h4>

<p>Our app calls these callbacks when we transition into or out of a view. For both options, we can set a function we want called; these functions have access to the resolved data. </p>

<p>These callbacks give us the ability to trigger an action on a new view or before we head out to another state. It&rsquo;s a good way to launch an &ldquo;Are you sure?&rdquo; modal view or request the user log in before they head into this state.</p>

<h4>Data</h4>

<p>We can attach arbitrary data to our state configObject. This data is similar in the <code>resolve</code> property, except that this data will <strong>not</strong> be injected into the controller, nor will <code>promises</code> be resolved. </p>

<p>Attaching data in this way is particularly useful when passing data to child states from a parent state.</p>

<h3>Events!</h3>

<p>Like the <code>ngRoute</code> service, the <code>angular-route</code> service fires events at different times during the state lifecycle. We can also attach actions to these events inside of our application by listening on the <code>$scope</code>. </p>

<p>All of the following events fire on the <code>$rootScope</code>, so we can listen to these events on any of our <code>$scope</code> objects:</p>

<h4>State change events</h4>

<p>We can listen to the events as follows:</p>
<pre class="highlight javascript"><span class="nx">$scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="s1">'$stateChangeStart'</span><span class="p">,</span> 
<span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">,</span> <span class="nx">toState</span><span class="p">,</span> <span class="nx">toParams</span><span class="p">,</span> <span class="nx">fromState</span><span class="p">,</span> <span class="nx">fromParams</span><span class="p">),</span> <span class="p">{</span>
  <span class="c1">// We can prevent this state from completing
</span>  <span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="p">});</span>
</pre>
<p>The events that fire are as follows:</p>

<h5><code>$stateChangeStart</code></h5>

<p>This event fires when the transition from one state to another <strong>begins</strong>.</p>

<h5><code>$stateChangeSuccess</code></h5>

<p>This event fires when the transition from one state to another <strong>is complete</strong>.</p>

<h5><code>$stateChangeError</code></h5>

<p>This event fires when an error occurs during the transition. Such errors are usually due to either a template that cannot be resolved or a resolve promise that fails to resolve.</p>

<h4>View load events</h4>

<p>The <code>ui-router</code> also provides events at the view loading stage:</p>

<h5>$viewContentLoading</h5>

<p>This event fires when the view begins loading and occurs before the DOM is rendered. </p>

<p>We can listen to this event like so:</p>
<pre class="highlight javascript"><span class="nx">$scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="s1">'$viewContentLoading'</span><span class="p">,</span> 
<span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">viewConfig</span><span class="p">){</span> 
    <span class="c1">// Access to all the view config properties.
</span>    <span class="c1">// and one special property 'targetView'
</span>    <span class="c1">// viewConfig.targetView 
</span><span class="p">});</span>
</pre>
<h5>$viewContentLoaded</h5>

<p>This event fires after the view has been loaded and after the DOM is rendered.</p>

<h3>$stateParams</h3>

<p>Above, we used the <code>$stateParams</code> to pick out the different <code>params</code> options from the <code>url</code> parameters. This service is how we&rsquo;ll hand data different components of our <code>url</code>. </p>

<p>For instance, if we have a URL in our <code>inbox</code> state that looks like:</p>
<pre class="highlight javascript"><span class="nx">url</span><span class="err">:</span> <span class="s1">'/inbox/:inboxId/messages/{sorted}?from&amp;to'</span>
</pre>
<p>and our user finds their way to this route:</p>
<pre class="highlight javascript"><span class="o">/</span><span class="nx">inbox</span><span class="o">/</span><span class="mi">123</span><span class="o">/</span><span class="nx">messages</span><span class="o">/</span><span class="nx">ascending</span><span class="p">?</span><span class="nx">from</span><span class="o">=</span><span class="mi">10</span><span class="o">&amp;</span><span class="nx">to</span><span class="o">=</span><span class="mi">20</span>
</pre>
<p>then our <code>$stateParams</code> object will result in:</p>
<pre class="highlight javascript"><span class="p">{</span><span class="na">inboxId</span><span class="p">:</span> <span class="s1">'123'</span><span class="p">,</span> <span class="na">sorted</span><span class="p">:</span> <span class="s1">'ascending'</span><span class="p">,</span> <span class="na">from</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="na">to</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
</pre>
<h3>$urlRouterProvider</h3>

<p>Just like <code>ngRoute</code>, we have access to a route provider that we can use to build rules around what happens when a particular URL is activated. </p>

<p>The states that we create activate themselves at different URLs, so the <code>$urlRouterProvider</code> is not necessary for managing activating and loading states. It does come in handy when we want to manage events that happen outside of the scope of our states, such as with redirection or authentication.</p>

<blockquote>
<p>We can use the <code>$urlRouterProvider</code> in our module&rsquo;s config function.</p>
</blockquote>

<h5><code>when()</code></h5>

<p>The <code>when</code> function takes two parameters: the incoming path that we want to match and the path that we want to redirect to (or a function that is invoked when we match the path).</p>

<p>To set up redirection, we&rsquo;ll set the <code>when</code> method to take a string. For instance, if we want to redirect an empty route to our <code>/inbox</code> route:</p>
<pre class="highlight javascript"><span class="p">.</span><span class="nx">config</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$urlRouterProvider</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$urlRouterProvider</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="s1">'/inbox'</span><span class="p">);</span>
<span class="p">});</span>
</pre>
<p>If we pass a function, then it will be <code>invoked</code> when we match the path. The handler can return one of three values:</p>

<ul>
<li><strong>falsy</strong> - This response tells the <code>$urlRouter</code> that the rule didn&rsquo;t match and it should try finding a different state that does match, which can be useful if we want to ensure a user has valid access to a URL.</li>
<li><strong>a string</strong> - The <code>$urlRouter</code> will treat a string value as a redirect URL.</li>
<li><strong>truthy or undefined</strong> - This response lets the <code>$urlRouter</code> know that we&rsquo;ve handled the URL.</li>
</ul>

<h5><code>otherwise()</code></h5>

<p>Just like the <code>otherwise()</code> method in <code>ngRoute</code>, the <code>otherwise()</code> method here redirects a user if no other routes are matched. This method is a good way to create a <em>default</em> URL, for instance.</p>

<p>The <code>otherwise()</code> method takes a single parameter: either a string or a function.</p>

<p>If we pass in a string, then any invalid or unmatched routes will be redirected to the string as a specified URL.</p>

<p>If we pass in a function, it will be invoked if no other route is matched, and we&rsquo;ll be responsible for handling the return.</p>
<pre class="highlight javascript"><span class="p">.</span><span class="nx">config</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$urlRouterProvider</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$urlRouterProvider</span><span class="p">.</span><span class="nx">otherwise</span><span class="p">(</span><span class="s1">'/'</span><span class="p">);</span>
  <span class="c1">// or
</span>  <span class="nx">$urlRouterProvider</span><span class="p">.</span><span class="nx">otherwise</span><span class="p">(</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">$injector</span><span class="p">,</span> <span class="nx">$location</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$location</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="s1">'/'</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre>
<h5><code>rule()</code></h5>

<p>If we want to bypass any of the URL matching or want to do some route manipulation before other routes, we can use the <code>rule()</code> function. </p>

<p>We must return a valid path as a string when using the <code>rule()</code> function: </p>
<pre class="highlight javascript"><span class="nx">app</span><span class="p">.</span><span class="nx">config</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$urlRouterProvider</span><span class="p">){</span>
  <span class="nx">$urlRouterProvider</span><span class="p">.</span><span class="nx">rule</span><span class="p">(</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">$injector</span><span class="p">,</span> <span class="nx">$location</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">'/index'</span><span class="p">;</span>
    <span class="p">});</span>
<span class="p">})</span>
</pre>
<h3>Create a sign-up wizard</h3>

<p>Why does it matter if we use a new, more powerful router than the built-in <code>ngRoute</code> provider? </p>

<p>A useful case for using the <code>ui-router</code> is when we want to create a sign-up wizard to walk our users through the process of signing up for our service.</p>

<p>Using the <code>ui-router</code>, we&rsquo;ll create a quick signup service with a single controller that can handle the signup.</p>

<p>First, we&rsquo;ll create a view for the app:</p>
<pre class="highlight html"><span class="nt">&lt;div</span> <span class="na">ng-controller=</span><span class="s">&quot;WizardSignupController&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h2&gt;</span>Signup wizard<span class="nt">&lt;/h2&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">ui-view</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre>
<p>Inside of this view, we&rsquo;ll house our signup views. Next, in our signup wizard we&rsquo;ll need three stages:</p>

<ul>
<li><strong>start</strong> - At this stage, we&rsquo;ll take the user&rsquo;s name and introduce him to our signup wizard.</li>
<li><strong>email</strong> - Here, we&rsquo;ll take the user&rsquo;s email in the second step.</li>
<li><strong>finish</strong> - At this point, the user will have completed our signup process and we&rsquo;ll simply show them a complete page. </li>
</ul>

<blockquote>
<p>In a <em>real</em> app, the <strong>finish</strong> stage would likely send the registration data back to a server and handle real registration. Here, we have no back end, so we&rsquo;ll just show the view.</p>
</blockquote>

<p>Our signup process will depend on a <code>wizardapp.controllers</code> module that houses our <code>WizardSignupController</code>.</p>
<pre class="highlight javascript"><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'wizardApp'</span><span class="p">,</span> <span class="p">[</span>
  <span class="s1">'ui.router'</span><span class="p">,</span>
  <span class="s1">'wizardapp.controllers'</span>
  <span class="p">]);</span>
</pre>
<p>Our <code>WizardSignupController</code> simply houses the <code>$scope.user</code> object that we&rsquo;ll carry with us through the signup process, as well as the signup action.  </p>
<pre class="highlight javascript"><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'wizardapp.controllers'</span><span class="p">,</span> <span class="p">[])</span>
<span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">'WizardSignupController'</span><span class="p">,</span> 
  <span class="p">[</span><span class="s1">'$scope'</span><span class="p">,</span> <span class="s1">'$state'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$state</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">signup</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">}]);</span>
</pre>
<p>Now, the wizard process logic houses the majority of the work. Let&rsquo;s set up this logic in the <code>config()</code> function of our app:</p>
<pre class="highlight javascript"><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'wizardApp'</span><span class="p">,</span> <span class="p">[</span>
  <span class="s1">'ui.router'</span><span class="p">,</span> <span class="s1">'wizardapp.controllers'</span>
  <span class="p">])</span>
<span class="p">.</span><span class="nx">config</span><span class="p">([</span><span class="s1">'$stateProvider'</span><span class="p">,</span> <span class="s1">'$urlRouterProvider'</span><span class="p">,</span>
<span class="kd">function</span><span class="p">(</span><span class="nx">$stateProvider</span><span class="p">,</span> <span class="nx">$urlRouterProvider</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$stateProvider</span>
    <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'start'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'/step_1'</span><span class="p">,</span>
      <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'partials/wizard/step_1.html'</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'email'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'/step_2'</span><span class="p">,</span>
      <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'partials/wizard/step_2.html'</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'finish'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'/finish'</span><span class="p">,</span>
      <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'partials/wizard/step_3.html'</span>
    <span class="p">});</span>
<span class="p">}]);</span>
</pre>
<p>With these options set up, we have our basic flow all done. Now, if the user navigates to the route <code>/step_1</code>, they are brought to the beginning of the flow. Although it might make sense that our entire flow takes place at the root URL (i.e., <code>/step_1</code>), we might want to house that flow in a sublocation (<code>/wizard/step_1</code>, for instance).</p>

<p>To do so, we&rsquo;ll set up an <code>abstract</code> state that houses the rest of our steps:</p>
<pre class="highlight javascript"><span class="p">.</span><span class="nx">config</span><span class="p">([</span><span class="s1">'$stateProvider'</span><span class="p">,</span> <span class="s1">'$urlRouterProvider'</span><span class="p">,</span>
<span class="kd">function</span><span class="p">(</span><span class="nx">$stateProvider</span><span class="p">,</span> <span class="nx">$urlRouterProvider</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$stateProvider</span>
    <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'wizard'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">abstract</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'/wizard'</span><span class="p">,</span>
      <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;div&gt;&lt;div ui-view&gt;&lt;/div&gt;&lt;/div&gt;'</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'wizard.start'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'/step_1'</span><span class="p">,</span>
      <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'partials/wizard/step_1.html'</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'wizard.email'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'/step_2'</span><span class="p">,</span>
      <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'partials/wizard/step_2.html'</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'wizard.finish'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'/finish'</span><span class="p">,</span>
      <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'partials/wizard/step_3.html'</span>
    <span class="p">});</span>
<span class="p">}]);</span>
</pre>
<p>Now, instead of having our routes at a top level, we can nest them safely inside our <code>/wizard</code> URL.</p>

<p>To navigate between our different states, we&rsquo;ll use the ui-router directive <code>ui-sref</code> on our links. This directive simply translates the <code>href</code> on the link to the next state.</p>

<p>For instance, our <code>step_1.html</code> looks like:</p>
<pre class="highlight html"><span class="c">&lt;!-- step_1.html --&gt;</span>
<span class="nt">&lt;h3&gt;</span>Step 1<span class="nt">&lt;/h3&gt;</span>
<span class="nt">&lt;form</span> <span class="na">ng-submit=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;user.name&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Your name&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">class=</span><span class="s">&quot;button&quot;</span> <span class="na">value=</span><span class="s">&quot;Next&quot;</span> <span class="na">ui-sref=</span><span class="s">&quot;wizard.email&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre>
<p>We also want to attach an action that happens at the end of the signup process that calls our <code>signup</code> function on our parent controller <code>WizardSignupController</code>. We&rsquo;ll set a controller on the final step of the wizard process that simply calls the function on the <code>$scope</code>. Because our entire wizard is encapsulated in our <code>WizardSignupController</code>, we&rsquo;ll be able to use the nested scope property of scopes like normal.</p>
<pre class="highlight javascript"><span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="s1">'wizard.finish'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">url</span><span class="p">:</span> <span class="s1">'/finish'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'partials/wizard/step_3.html'</span><span class="p">,</span>
  <span class="na">controller</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">signup</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre>
<div id="wizard"></div>

<h4>See it</h4>

<div ari-iframe>
  <div ng-app="wizardApp">
    <div ng-controller="WizardSignupController">
      <h2>Signup wizard</h2>
      <div ui-view></div>
    </div>
  </div>
  <script type="text/javascript" src="/js/vendor/angular-ui-router/release/angular-ui-router.min.js"></script>
  <script type="text/javascript">
    angular.module('wizardApp', [
      'ui.router',
      'wizardapp.controllers'
      ])
    .config(['$stateProvider', '$urlRouterProvider', function($stateProvider, $urlRouterProvider) {
      $urlRouterProvider.otherwise('/wizard/start');

      $stateProvider
        .state('wizard', {
          abstract: true,
          url: '/wizard',
          template: '<div>\
            <div ui-view></div>\
            </div>'
        })
        .state('wizard.start', {
          url: '/start',
          template: '<h3>Step 1</h3>\
            <form ng-submit="">\
            <input type="text" ng-model="user.name" placeholder="Your name" />\
            <input type="submit" class="button" value="Next" ui-sref="wizard.email"/>\
            </form>\
          '
        })
        .state('wizard.email', {
          url: '/email',
          template: '<h3>Step 2</h3>\
            <form ng-submit="">\
            <input type="email" ng-model="user.email" placeholder="Your email" />\
            <input type="submit" class="button" value="Next" ui-sref="wizard.finish"/>\
            </form>\
          '
        })
        .state('wizard.finish', {
          url: '/complete',
          template: '<h3>Congrats! You signed up!</h3>\
            <h5>Your name: {{ user.name }}</h5>\
            <h5>Your email: {{ user.email }}</h5>\
            <a class="button" ui-sref="wizard.start">Start over</a> \
          ',
          controller: function($scope) {
            $scope.signup();
          }
        })
    }]);
    angular.module('wizardapp.controllers', [])
    .controller('WizardSignupController', ['$scope', '$state', function($scope, $state) {
      $scope.user = {};
      $scope.signup = function() {
      }
    }]);
  </script>
  <style type="text/css">
    body {
      padding: 0 15px;
    }
  </style>
</div>

<p><a href="https://gist.github.com/auser/6590977" target="_blank">Full source</a></p>

<p>In this post, we covered the <code>ui-router</code> in-depth and almost the entirety of the features. We find the library incredibly useful and we hope you do too.</p>

<p>Feel free to ping us with any questions, comments, or just to say hey and stay tuned for news about our upcoming AngularJS book. It covers this topic and much much more. Sign up on the mailing list below to receive a free sample chapter of the book.</p>

<script type="text/javascript" src="/js/vendor/angular-ui-router/release/angular-ui-router.min.js"></script>

<script type="text/javascript" src="/js/posts/d3.js"></script>

<script type="text/javascript">
  angular.module('uiAngularApp', [
    'ngNewsletter', 
    'ariIframe',
    ]);
</script>


          <div class="container" id="signupApp" ng-cloak>
  <div id="topbar_signup_embed">
  Get the weekly email all focused on AngularJS. <b>Sign up below</b> to receive the weekly email and exclusive content.
  <form name="ngSignup" action="http://willcodeforfoo.us6.list-manage1.com/subscribe/post?u=86d6f14c7cc955128485e3b8e&amp;id=fa61364f13" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    
    <div class="row collapse">
      <div class="small-9 columns">
        <input ng-class="{error: ngSignup.email.$dirty && ngSignup.email.$invalid}" type="email" ng-minlength=3 ng-model="ngSignup.email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="Email address" required>
      </div>
      <div class="small-3 columns">
        <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" ng-disabled="ngSignup.$invalid" class="button postfix"></div>
      </div>
        <div class="small-12 columns error" ng-show="ngSignup.EMAIL.$dirty && ngSignup.EMAIL.$invalid">
          <small class="error" ng-show="ngSignup.EMAIL.$error.required">Your email is required.</small>
          <small class="error" ng-show="ngSignup.EMAIL.$error.minlength">Your email is required to be at least 3 characters</small>
          <small class="error" ng-show="ngSignup.EMAIL.$error.email">That is not a valid email. Please input a valid email.</small>
        </div>
      </div>
  </form>
  </div>
</div>

<script type="text/javascript">
  if (typeof(app) == 'undefined') {
    angular.module("signupApp", [])
    .controller("mailChimpValidation", ['$scope', function($scope) {}]);
    var ele = document.getElementById("signupApp");
    angular.element(ele, ['signupApp']);
  }
</script>
          <section id="sample_chapter" ng-app="ngBookApp">    <div class="content">      <h3 class="title">Download a free sample of the ng-book: The Complete Book on AngularJS</h3> <span class="image"><img src="http://www.ng-book.com/images/flatbook-ngbook-small.png" alt="book"></span><div class="desc">It's free, so just enter your email address and the PDF will be sent directly to your inbox.</div>    </div>    <div class="form" ng-init="signedup=false" ng-show="!signuped">      <form action="http://willcodeforfoo.us6.list-manage.com/subscribe/post?u=86d6f14c7cc955128485e3b8e&amp;id=7bbfaae868" method="post" id="mc-embedded-subscribe-form" name="ngBookSignup" class="validate ng-pristine ng-invalid ng-invalid-required" target="_blank" novalidate="">
<div class="mc-field-group">          <input type="email" ng-model="ngBookSignup.email" ng-class="{error: ngBookSignup.email.$dirty &amp;&amp; ngBookSignup.email.$invalid}" value="" name="EMAIL" placeholder="Your email address" class="required email ng-pristine ng-valid ng-valid-email ng-valid-minlength" id="mce-EMAIL" ng-minlength="3">        </div>        <div id="mce-responses" class="clear">          <div class="response" id="mce-error-response" style="display:none"></div>          <div class="response" id="mce-success-response" style="display:none"></div>        </div>        <div class="clear"><input type="submit" value="Send me a free chapter" name="subscribe" id="ngBookSignupSubmit" ng-disabled="ngBookSignup.$invalid" class="button postfix" ng-click="signedup=true" disabled="disabled"></div>      </form>      <div ng-show="signedup" class="ng-hide">      <p>Sweet! We are glad to hear you're interested in learning AngularJS. Enjoy the free chapter. We put a lot of work into building the book series, so we hope you like it!      Talk soon</p>      </div>      <div class="desc">        We won't ever send you spam! You can unsubscribe at any time.      </div>    </div>  </section>

          <footer>
            <ul class="actions">
              <li><a href="/articles"><span class="arrow"></span> Back to articles</a></li>
              <li><a href="http://twitter.com/home/?status=Diving deep into the AngularUI Router - http://ng-newsletter.com/posts/angular-ui-router.html via @ngnewsletter" target="_blank"><img src="/img/twitter-bird-blue-on-white.png" style="width: 56px; height: 26px;" />Share on twitter</a></li>
            </ul>
          </footer>

        </article>

        <section id="comments">
            <h2 class="gamma">Comments</h2>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ngnewsletter'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>

        

        <script type="text/javascript" src="/js/vendor/zepto.js"></script>
<script type="text/javascript" src="/js/vendor/foundation.min.js"></script>

<script src="/js/main.js"></script>

        </div>
    </div>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28176211-3', 'ng-newsletter.com');
  ga('send', 'pageview');

</script>

<script type="text/javascript">
  var $mcGoal = {'settings':{'uuid':'86d6f14c7cc955128485e3b8e','dc':'us6'}};
  (function() {
     var sp = document.createElement('script'); sp.type = 'text/javascript'; sp.async = true; sp.defer = true;
    sp.src = ('https:' == document.location.protocol ? 'https://s3.amazonaws.com/downloads.mailchimp.com' : 'http://downloads.mailchimp.com') + '/js/goal.min.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(sp, s);
  })(); 
</script>

</body>
</html>
