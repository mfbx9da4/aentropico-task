/*! blog 2014-02-05 */
function buildGraphFromId(a,b){a.get("/jobs/"+b).success(function(a){var b=lineChart().width($("#graph").width()).height($("#graph").width()/2).x(function(a){return+a.x}).y(function(a){return+a.y});b("#graph",a.data)})}function lineChart(){function a(a,l){var m=d3.select(a).append("svg").attr("width",c+b.left+b.right).attr("height",d+b.top+b.bottom).append("g").attr("transform","translate("+b.left+","+b.top+")"),n=d3.csv.parse(l);g.range([0,c-b.left-b.right]).domain(d3.extent(n,e)),h.range([d-b.top-b.bottom,0]).domain(d3.extent(n,f)),m.append("g").attr("class","x axis").attr("transform","translate(0,"+(d-b.top-b.bottom)+")").call(i),m.append("g").attr("class","y axis").call(j).append("text").attr("transform","rotate(-90)"),m.append("path").datum(n).attr("class","line").attr("d",k)}var b={top:20,right:20,bottom:30,left:50},c=760-b.left-b.right,d=120-b.top-b.bottom,e=function(a){return a[0]},f=function(a){return a[1]},g=d3.scale.linear(),h=d3.scale.linear(),i=d3.svg.axis().scale(g).orient("bottom"),j=d3.svg.axis().scale(h).orient("left"),k=d3.svg.line().x(function(a){return g(a.x)}).y(function(a){return h(a.y)});return a.margin=function(c){return arguments.length?(b=c,a):b},a.width=function(b){return arguments.length?(c=b,a):c},a.height=function(b){return arguments.length?(d=b,a):d},a.x=function(b){return arguments.length?(e=b,a):e},a.y=function(b){return arguments.length?(f=b,a):f},a}var AentropicoApp=angular.module("AentropicoApp",["angularFileUpload","ngRoute"]);AentropicoApp.config(function(a){a.when("/about",{templateUrl:"../README.html",controller:"aboutController"}).when("/jobs/:jobId",{templateUrl:"../html/upload.html",controller:"uploadController"}).when("/jobs",{templateUrl:"../html/upload.html",controller:"uploadController"}).otherwise({redirectTo:"/jobs"})}),AentropicoApp.controller("uploadController",["$scope","$http","$upload","$location","$routeParams",function(a,b,c,d,e){window.sc=a,e.jobId&&buildGraphFromId(b,e.jobId),a.onFileSelect=function(b){var e=$("#percent-complete");e.width("0%").parent().show();var f=b[0];a.upload=c.upload({url:"/algorithms",method:"POST",file:f}).then(function(a){if(!a.data.success)throw a.data.message;d.path("jobs/"+a.data.jobId)},null,function(a){e.width(parseInt(100*a.loaded/a.total)+"%")})}}]),AentropicoApp.controller("aboutController",["$scope",function(){}]),AentropicoApp.controller("reportController",["$scope","$http","$routeParams",function(a,b,c){buildGraphFromId(b,c.jobId)}]);